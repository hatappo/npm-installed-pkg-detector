
<div align="center"> en | <a href="README_ja.md">ja</a> </div>


--------------------------------------------------------------------------------

A collection of tools for detecting npm packages and their versions in `package-lock.json` files.

# 1. detect.sh

Tool for batch detection of multiple npm packages and versions from package-lock.json

## Requirements

- bash / zsh
- jq

### Supported Format

This tool only supports **lockfileVersion 3** (package-lock.json format generated by npm 7 and later).

## Usage

```bash
./detect.sh <list-file-path> [lock-file-path]
```

- `list-file-path`: File containing target packages to detect (required)
- `lock-file-path`: Path to package-lock.json (default: ./package-lock.json)

## Exit Codes

- `0`: Normal exit (no version matches)
- `1`: Error
- `2`: Version matches found

## List File Format

```
jest ( 29.7.0 , 29.6.0 )
typescript ( 5.3.3 )
express
```

## Examples

```bash
# Normal execution (shows only detected packages)
$ ./detect.sh package-list.txt
✓ jest: detected (target versions: 29.7.0 )
  → Version 29.7.0: detected
✓ typescript: detected (target versions: 5.3.3 )
  → Version 5.3.3: detected

=== Detection Summary ===
Detected packages: 2/3, Detected versions: 2/3

# Verbose mode (shows all packages including not detected)
$ VERBOSE=1 ./detect.sh package-list.txt
✓ jest: detected (target versions: 29.7.0 )
  → Version 29.7.0: detected
  → Version 29.6.0: not detected
✗ express: not detected

=== Detection Summary ===
Detected packages: 1/2, Detected versions: 1/2
```

## Environment Variables

- `VERBOSE=1`: Shows all output including not detected packages.

--------------------------------------------------------------------------------

# 2. detect-remote.sh

Tool for checking package-lock.json directly from GitHub repositories

## Requirements

- gh (GitHub CLI) - Authentication required (`gh auth login`)
- jq
- base64

## Usage

```bash
./detect-remote.sh <org/repo> <list-file-path>
```

- `org/repo`: GitHub repository (e.g., facebook/react)
- `list-file-path`: File containing target packages to detect

## Examples

```bash
# Check packages in remote repository
$ ./detect-remote.sh facebook/react package-list.txt

# Verbose mode
$ VERBOSE=1 ./detect-remote.sh microsoft/vscode package-list.txt
```

## Notes

- GitHub API limits files to 1MB maximum
- GitHub CLI authentication required (`gh auth status` to verify)
- Fetched files are temporarily stored in work/ directory (automatically deleted)

--------------------------------------------------------------------------------

# 3. detect-org.sh

Tool for batch checking all repositories in a GitHub Organization

## Requirements

- gh (GitHub CLI) - Authentication required (`gh auth login`)
- jq
- detect-remote.sh must exist in the same directory

## Usage

```bash
./detect-org.sh <org-name> <list-file-path>
```

- `org-name`: GitHub Organization name (e.g., facebook, microsoft)
- `list-file-path`: File containing target packages to detect

## Examples

```bash
# Scan entire Organization
$ ./detect-org.sh facebook package-list.txt

# Verbose mode
$ VERBOSE=1 ./detect-org.sh microsoft vulnerable-packages.txt
```

## Exit Codes

- `0`: No detections in all repositories
- `1`: Error
- `2`: Detections found in one or more repositories

## Process

1. Fetch repository list from Organization using `gh repo list` (max 1000)
2. Execute `detect-remote.sh` for each repository sequentially
3. Aggregate results and display summary

## Notes

- Does not support Organizations with more than 1000 repositories (`gh repo list "$ORG_NAME" --limit 1000`)
